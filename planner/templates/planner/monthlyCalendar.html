{% extends 'base/base_sidebar.html' %}
{% load static %}

{% block title %}
  Calendar View
{% endblock %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Calendar</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/htmx.org"></script>
  </head>
  <body class="flex flex-col md:flex-row">
    <!-- Sidebar -->
    <div class="sidebar fixed inset-y-0 left-0 bg-zinc-800 text-white w-52 flex flex-col justify-between z-50">
      <!-- Sidebar content -->
    </div>

    <!-- Main content area -->
    <div class="main-content ml-52 flex-1 overflow-hidden">
      {% block content %}
        <style>
          /* Calendar styles */
          #calendar-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100%;
            padding: 20px;
            overflow-y: scroll; /* Enable vertical scrolling if needed */
          }
          
          #calendar {
            max-width: 100%;
            width: 800px; /* Adjust width as needed */
            height: 100%;
            border: 2px solid red; /* Temporary border for debugging */
            padding: 20px;
          }
        </style>
        <div id="calendar-container">
          <div id="calendar"></div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js"></script>
        <script>
          // Define an array to store FullCalendar events
          {% comment %} var fullCalendarEvents = []
          
          // Loop through assignments_by_day data from Django
          for (var assignments in assignments_by_day) {
            for (var assignment in assignments) {
              // Extract relevant information from assignment
              var title = '{{ assignment.title }}'
              var start = '{{ assignment.due_date }}' // Use the due_date or start_date field from your model
              var end = '{{ assignment.due_date }}' // Use the due_date or end_date field from your model
          
              // Create an event object and push it to the events array
              var event = {
                title: title,
                start: start,
                end: end
                // You can add more properties here if needed
              }
              fullCalendarEvents.push(event)
            }
          } {% endcomment %}
          // Use fullCalendarEvents array as events data for FullCalendar
          document.addEventListener('DOMContentLoaded', function () {
            var calendarEl = document.getElementById('calendar')
          
            var calendar = new FullCalendar.Calendar(calendarEl, {
              initialView: 'dayGridMonth',
              headerToolbar: {
                left: 'prev,next today',
                center: 'title',
                right: 'dayGridMonth,timeGridWeek,timeGridDay'
              },
              // Use the array of events here
              events: {
                title: 'All Day Event',
                start: '2024-04-11'
              }
            })
          
            calendar.render()
          })
        </script>
      {% endblock %}
    </div>
  </body>
</html>
